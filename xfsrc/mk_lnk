#!/bin/sh

set -e

TARGET=$1

case $TARGET in
	${MK_EXENAME}|${MK_RTNAME}|${MK_UNREGNAME})
		OUTPUT=${TARGET}${MK_EXEEXT}
		ARCHIVE="${MK_LIBDECF} ${MK_LIBPCRE}"
		;;
	${MK_DLLNAME}|${MK_DLLRTNAME})
		OUTPUT=${TARGET}${MK_DLLEXT}
		ARCHIVE="${MK_LIBDECF} ${MK_LIBPCRE}"
		;;
	${MK_ENGINENAME})
		OUTPUT=lib${TARGET}${MK_DLLEXT}
		LNK_FLAGS="-shared -Wl,-soname,$(basename $OUTPUT)"
		ARCHIVE="${MK_LIBDECF} ${MK_LIBPCRE}"		
		;;
	*)
		OUTPUT=$TARGET
		;;
esac

shift
ALLOBJS=$*

cd $OBJDIR
mk_lnk_linux $OUTPUT $LNK_FLAGS $ALLOBJS $ARCHIVE
